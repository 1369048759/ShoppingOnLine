var $Dialog=(function(){function g(m){m=m.toLowerCase();var k=navigator.userAgent.toLowerCase();var l=false;switch(m){case"chrome":l=k.indexOf("chrome")!=-1;break;case"firefox":l=k.indexOf("firefox")!=-1;break;case"opera":l=k.indexOf("opera")!=-1;break;case"safari":l=k.indexOf("safari")!=-1&&k.indexOf("chrome")==-1;break;case"ie":l=k.indexOf("msie")!=-1;break;case"ie6":l=k.indexOf("msie 6")!=-1;break;case"ie7":l=k.indexOf("msie 7")!=-1;break;case"ie8":l=k.indexOf("msie 8")!=-1;break;case"ie9":l=k.indexOf("msie 9")!=-1;break;case"ie10":l=k.indexOf("msie 10")!=-1;break;case"gecko":l=k.indexOf("opera")==-1&&k.indexOf("safari")==-1&&k.indexOf("chrome")==-1&&k.indexOf("gecko")>-1;break;}return l;}function f(){var k=document.body;var l=document.compatMode=="BackCompat"?k:document.documentElement;return l.scrollTop==0?k.scrollTop:l.scrollTop;}function c(){var k=document.body;var l=document.compatMode=="BackCompat"?k:document.documentElement;return l.scrollLeft==0?k.scrollLeft:l.scrollLeft;}function e(){var k=document.body;return(document.compatMode=="BackCompat"?k:document.documentElement).clientHeight;}function b(){var k=document.body;return(document.compatMode=="BackCompat"?k:document.documentElement).clientWidth;}function j(){var k=document.body;var l=document.compatMode=="BackCompat"?k:document.documentElement;return(window.MessageEvent&&navigator.userAgent.toLowerCase().indexOf("firefox")==-1)?k.scrollHeight:l.scrollHeight;}function d(){var k=document.body;var l=document.compatMode=="BackCompat"?k:document.documentElement;return(window.MessageEvent&&navigator.userAgent.toLowerCase().indexOf("firefox")==-1)?k.scrollWidth:l.scrollWidth;}function a(o,m,p){if(!o||!m||!p){return;}if(o instanceof Array){for(var l=0,k=o.length;l<k;l++){a(o[l],m,p);}return;}if(m instanceof Array){for(var l=0,k=m.length;l<k;l++){a(o,m[l],p);}return;}if(!a.createDelegate){a.createDelegate=function(r,q){return function(){return r.apply(q,arguments);};};}var n=a.createDelegate(p,o);if(window.addEventListener){o.addEventListener(m,n,false);}else{if(window.attachEvent){o.attachEvent("on"+m,n);}else{alert("你的浏览器太out了");}}return n;}function i(l,k,m){if(window.removeEventListener){l.removeEventListener(k,m,false);}else{l.detachEvent("on"+k,m);}}function h(k){var l={width:400,height:"auto",left:0,top:0,zIndex:10001,title:"Dialog",html:"",showClose:true,mask:true,opacity:0.4,autoResize:true,dragble:true,className:"",cssUrl:"",onInit:null,onClose:null};for(var n in k){l[n]=k[n];}this.option=l;if(l.cssUrl){$loadCss(l.cssUrl);}this.init();var m=this;l.onInit&&l.onInit(m);}h.prototype={constructor:h,init:function(){var o=this,m=o.option;var k=document.createElement("div");var q=document.createElement("div");var p=document.createElement("a");var l=document.createElement("div");k.style.position="absolute";k.style.zIndex=m.zIndex;k.className="ui_dialog "+m.className;q.innerHTML=m.title;q.className="ui_dialog_title";m.title.length?q.style.display="block":q.style.display="none";p.innerHTML="&times;";p.href="javascript:void(0);";p.target="_self";p.className="ui_dialog_close";m.showClose?p.style.display="block":p.style.display="none";l.innerHTML=m.html;l.className="ui_dialog_content";k.appendChild(q);k.appendChild(p);k.appendChild(l);o.domDialog=k;o.domTitle=q;o.domClose=p;o.domContent=l;if(m.mask){o.domMask=document.createElement("div");if(g("ie6")||g("ie7")){o.domMask.style.position="fixed";o.domMask.style.width="100%";o.domMask.style.height="100%";o.domMask.style.top=0;o.domMask.style.left=0;o.domMask.style.zIndex=m.zIndex;o.domMask.style.backgroundColor="#000000";o.domMask.style.filter="alpha(opacity="+m.opacity*100+")";if(g("ie6")){o.domMask.style.position="absolute";}}else{o.domMask.setAttribute("style","position:fixed;width:100%;height:100%;top:0;left:0;z-index:"+m.zIndex+";background-color:#000;opacity:"+m.opacity+";filter:alpha(opacity="+m.opacity*100+");");}document.body.appendChild(o.domMask);}if(g("ie6")){var n=document.createElement("iframe");n.style.position="absolute";n.style.width="100%";n.style.height="100%";n.style.top=0;n.style.left=0;n.style.zIndex=m.zIndex;n.style.border="none";n.style.filter="alpha(opacity=0)";n.setAttribute("allowtransparency","yes");n.setAttribute("backgroundColor","#000000");o.domIframe=n;document.body.appendChild(o.domIframe);}document.body.appendChild(k);if(g("ie6")){o.setPos=o.setPosIe6;}a(p,"click",function(){o.hide();o.option.onClose&&o.option.onClose.apply(o,arguments);return false;});o.show();},show:function(){var m=this,l=m.option,k=m.domDialog;if(l.mask){m.domMask.style.display="block";}k.style.display="block";k.style.height="";k.style.width="";m.height=(l.height=="auto"?k.clientHeight:l.height);m.width=(l.width=="auto"?k.clientWidth:l.width);k.style.height=m.height+"px";k.style.width=m.width+"px";if(g("ie6")){m.domIframe.style.display="block";m.domIframe.style.height=m.height+"px";m.domIframe.style.width=m.width+"px";}m.setPos();if(l.autoResize){m.setAutoResize();}else{if(g("ie6")){m.setResizeIe6();}}},hide:function(){var l=this,k=l.option;l.domDialog.style.display="none";if(l.domMask){l.domMask.style.display="none";}if(g("ie6")){l.domIframe.style.display="none";}if(k.autoResize){l.cancelAutoResize();}else{if(g("ie6")){l.cancelResizeIe6();}}},setPos:function(){var t=this,n=t.option,u=t.domDialog;var r=c(),o=f(),s=b(),w=e();var l=d(),v=j();var m=[0,0];if(t.width>s){var k=parseInt(u.style.left)||0;if(k>r){m[0]=r;}else{if(k+t.width>s+r-10){m[0]=k;}else{m[0]=r+s-t.width;}}}else{m[0]=parseInt((s-t.width)/2)+r;}if(t.height>w){var q=parseInt(u.style.top)||0;if(q>o){m[1]=o;}else{if(q+t.height>w+o-10){m[1]=q;}else{m[1]=o+w-t.height;}}}else{m[1]=o+parseInt((w-t.height)/2);}m[0]=m[0]>0?m[0]:0;m[1]=m[1]>0?m[1]:0;u.style.left=m[0]+"px";u.style.top=m[1]+"px";},setPosIe6:function(){var u=this,n=u.option,v=u.domDialog;var r=c(),o=f(),s=b(),y=e();var l=d(),w=j();var m=[0,0];if(u.width>s){var k=parseInt(v.style.left)||0;if(k>r){m[0]=r;}else{if(k+u.width>s+r-10){m[0]=k;}else{m[0]=r+s-u.width;}}}else{m[0]=parseInt((s-u.width)/2)+r;}if(u.height>y){var q=parseInt(v.style.top)||0;if(q>o){m[1]=o;}else{if(q+u.height>y+o-10){m[1]=q;}else{m[1]=o+y-u.height;}}}else{m[1]=o+parseInt((y-u.height)/2);}m[0]=m[0]>0?m[0]:0;m[1]=m[1]>0?m[1]:0;v.style.left=m[0]+"px";v.style.top=m[1]+"px";if(n.mask){var t=w>y?w+"px":y+"px",x=l>s?l+"px":s+"px";u.domMask.style.width=x;u.domMask.style.height=t;u.domIframe.style.width=x;u.domIframe.style.height=t;}else{u.domIframe.style.left=m[0]+"px";u.domIframe.style.top=m[1]+"px";}},setAutoResize:function(){var k=this;k._outoResizeHandle=a(window,"scroll",function(){k.setPos();});k._outoResizeHandle=a(window,"resize",function(){k.setPos();});},cancelAutoResize:function(){var k=this;i(window,"scroll",k._outoResizeHandle);i(window,"resize",k._outoResizeHandle);},setResizeIe6:function(){var k=this;k._resizeIe6Handle=a(window,"resize",function(p){if(k.option.mask){var n=b(),q=e(),o=d(),l=j();var m=l>q?l:q,r=o>n?o:n;k.domMask.style.height=m+"px";k.domMask.style.width=r+"px";k.domIframe.style.height=m+"px";k.domIframe.style.width=r+"px";}});},cancelResizeIe6:function(){var k=this;i(window,"resize",k._resizeIe6Handle);},setContent:function(k){var l=this;l.domContent.innerHTML=k||"";}};return function(k){return new h(k);};})();