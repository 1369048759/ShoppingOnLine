function $ImgView(d,c){var b=this;b._selfId=++b.constructor._newNum;b._selfName=".$ImgView"+b._selfId;if(d==c||d.obj==c){return false;}b.config=$.extend({},b.config,d.config);b.obj=$(d.obj);var a=b.config;b.oPanel=b.obj.find(a.selectorPanel);b.oBtnPre=b.obj.find(a.selectorPre);b.oBtnNext=b.obj.find(a.selectorNext);b.oItems=b.oPanel.find(a.selectorItems);b.oItemsLi=b.oPanel.find(a.selectorItemsLi);b.oBigImg=$(d.oBigImg);}$ImgView.prototype={config:{pos:0,speed:400,selectorPre:".pre",selectorNext:".next",selectorPanel:".panel",selectorItems:".item",selectorItemsLi:"li",cssItemCurr:"curr",isDelay:false,onMoveBefore:null},init:function(){var b=this,a=b.config;b.sum=b.oItems.length;if(b.sum==0){return false;}if(b.sum==1){a.pos=0;b.oBtnPre.hide();b.oBtnNext.hide();}else{b.oBtnPre.bind("click",b,b.preHandler);b.oBtnNext.bind("click",b,b.nextHandler);}b.initStatus();if(a.isDelay){a.onMoveBefore=b.fnDelay;$(window).bind("scroll"+b._selfName+" resize"+b._selfName,b,b.fnDelay);b.fnDelay();}b.oItemsLi.bind("mouseenter",b,b.enterHandler);b.oItemsLi.bind("mouseleave",b,b.leaveHandler);},initStatus:function(){var b=this,a=b.config;b.oItemFirst=b.oItems.eq(0);b.itemValue=b.oItemFirst.outerHeight();b.obj.css({position:"relative",overflow:"hidden"});b.oPanel.css({position:"relative",overflow:"hidden",height:b.itemValue*(b.sum+1)});b.oItemFirst.css({position:"relative",top:0});var c=b.formatePos(a.pos);a.pos=c;b.oPanel.css({top:-c*b.itemValue});b.setStatus();},setStatus:function(){var c=this,a=c.config;c.oItemsLi.removeClass(a.cssItemCurr);var b=c.oItems.eq(a.pos).children().eq(0);b.addClass(a.cssItemCurr);c.oBigImg.attr("src",b.attr("data_src"));},move:function(){var b=this,a=b.config;if(a.onMoveBefore!=null){b.onMoveBefore=a.onMoveBefore;b.onMoveBefore();}b.movefun();},movefun:function(){var b=this,a=b.config;if(a.pos>=b.sum){a.pos=0;b.oPanel.stop(false,true);b.oItemFirst.css({top:b.sum*b.itemValue});b.oPanel.animate({top:-b.sum*b.itemValue},a.speed,function(){b.oItemFirst.css({top:0});b.oPanel.css({top:0});});}else{if(a.pos<0){a.pos=b.sum-1;b.oPanel.stop(false,true);b.oItemFirst.css({top:b.sum*b.itemValue});b.oPanel.css({top:-b.sum*b.itemValue});b.oPanel.animate({top:-(b.sum-1)*b.itemValue},a.speed,function(){b.oItemFirst.css({top:0});});}else{b.oPanel.stop(false,true);b.oPanel.animate({top:-a.pos*b.itemValue},a.speed);}}b.setStatus();},preHandler:function(c){var b=c.data,a=b.config;a.pos--;b.move();c.stopPropagation();},nextHandler:function(c){var b=c.data,a=b.config;a.pos++;b.move();c.stopPropagation();},enterHandler:function(d){var b=d.data,a=b.config,c=$(this);b._hoverTimeout=setTimeout(function(){b.oItemsLi.removeClass(a.cssItemCurr);c.addClass(a.cssItemCurr);b.oBigImg.attr("src",c.attr("data_src"));},200);},leaveHandler:function(b){var a=b.data;clearTimeout(a._hoverTimeout);},formatePos:function(b){var a=this.config.sum;if(b<0){b=0;}else{if(b>=a){b=a-1;}}return b;},fnDelay:function(n,c){var a=(n&&n.data)||this,q;if(!a.oDelayImgs){a.oDelayImgs=[];a.oItems.each(function(){var e=[];q=$(this).find("img");q.each(function(){if($(this).attr("orial_src")){e.push(this);}});a.oDelayImgs.push(e);});}var p=a.formatePos(a.config.pos);if(a.oDelayImgs[p]&&a.oDelayImgs[p].length!=0){var o=$(window);var l=o.scrollTop(),h=o.height(),g=l+h;var k=a.oDelayImgs[p],m=k.length,f,b;for(var j=0;j<m;j++){var d=$(k[j]);f=parseInt(d.offset().top);b=parseInt(f+(d.outerHeight()||800));if((f>=l&&f<=g)||(b>=l&&b<=g)||(f<l&&b>g)){d.attr("src",d.attr("orial_src"));k.splice(j,1);j--;m--;}}}for(var j=0;j<a.sum;j++){if(a.oDelayImgs[j].length!=0){break;}}if(j==a.sum){a.config.onMoveBefore=null;$(window).unbind("resize"+a._selfName+" scroll"+a._selfName);}}};$ImgView.prototype.constructor=$ImgView;$ImgView._newNum=0;